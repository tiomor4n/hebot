<html>
<head>
    <title>連結到LineNotify</title>
	<meta charset="big-5" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <script type='text/javascript'>
        function oAuth2() {
		    var vemail = document.getElementById("emailsc").value
            var URL = 'https://notify-bot.line.me/oauth/authorize?';
            URL += 'response_type=code';
            URL += '&client_id=nch5lTjwJmgdHwx5Ar4oaJ';
            URL += '&redirect_uri=https://test-pro-tiomor4n.c9.io/index/';
            URL += '&scope=notify';
            URL += '&state=';
			URL += vemail;
            //window.location.href = URL;
			alert(URL);
        }
        
        function teststart(){
            document.getElementById("linecode").value = 'test';
        }
        document.ready(showemail);
        
        function showemail(){
            document.getElementById("email").value =  getParameterByName('state',window.location);
        }
        
        function showcode(){
              document.getElementById("mytextbox").value = getParameterByName('code',window.location);
        };
        
        function getParameterByName(name, url) {
            if (!url) {
                url = window.location.href;
            }
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
        
    </script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<style>
	    .jumbotron { 
                     background-color: #f4511e; /* Orange */
                     color: #ffffff;
		}
	</style>
</head>
<body>
    
    
    <div class="jumbotron text-center" >
	    <h1>訂閱RateAnyWHere Line Notify<h1>
		<p>訂閱屬於你的匯率通知</p>
		<form class="form-inline">
		
            <div class="input-group">
				<input type="email" id="emailsc" class="form-control" size="50" placeholder="Email Address" required>
			<div class="input-group-btn">
                <button type="button" class="btn btn-danger" onclick="oAuth2();">Subscribe</button>
            </div>
            </div>
        </form>
	</div>
	<div class="container">
	<!--<button type="button" class="btn btn-primary" onclick="oAuth2();">連結到LineNotify按鈕</button>-->
    <form action="/request_page/" method="post" class="form-group">{% csrf_token %}
        
            <input type="text" name="mytextbox" id='mytextbox' size="1" style="visibility:hidden"/><br/>
            
			<label for="email">請輸入email:</label>
			<input type="text" name="email" id="email" rows="1" size = "20" class="form-control"/>
		
			<label for="nickname">請輸入暱稱:</label>
			<input type="text" name="nickname" id="nickname" size = "10" class="form-control"/>
			
			<!--銀行名稱:<input type='text' name="banktextbox" id="banktextbox" size = "8"/><br/>-->
			
			<label for="BS">請輸入買賣別B/S</label>
			<input type='text' name="BS" id="BS" size = "1" class="form-control"/>
			
			<label for="ccy">請輸入幣別:</label>
			<input type='text' name="ccy" id="ccy" size = "3" class="form-control"/>
			
			<label for="exrate">請輸入匯率:
			<input type='text' name="exrate" id="exrate" size = "6" class="form-control">
				
   		    <button name='gettoken' type="button" class="btn btn-default" onclick="showcode()">POST取得token</button>
    </form>
    
    <form action="/posttestget/" method="post">{% csrf_token %}
        <button id='sendpost' name='sendpost'>送訊息測試</button>
        <input type="text" name="entry" id='entry' size="10"/>
    </form>
    </div>
</body>
</html>